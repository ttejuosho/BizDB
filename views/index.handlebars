<!-- Header -->
<header class="bg-primary py-5 mb-5">
  <div class="container h-100">
    <div class="row h-100 align-items-center">
      <div class="col-lg-12">
        <h1 class="display-4 text-white mt-5 mb-2">Search Chicago Businesses</h1>
        {{!-- <small id="passwordHelpBlock" class="form-text text-muted">Search chicago businesses by any keyword</small> --}}
        <p class="lead mb-5 text-white-50">Search chicago businesses by any keyword in our {{count}} records database
        </p>
        <form>
          <div class="form-row">
            <div class="col-12 col-md-9 mb-2 mb-md-0">
              <input type="text" id="searchBy" class="form-control form-control-lg" placeholder="Search">
            </div>
            <div class="col-12 col-md-3">
              <button type="button" class="btn btn-block btn-lg btn-warning" id="goSearch">Search</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</header>

<div class="container">
  <div class="row" id="resultsDiv">

  </div>
</div>
<script type="text/javascript">
  $("#goSearch").click(() => {
    loadBusinessData();
  });

  $(document).keypress(function (e) {
    var keycode = (e.keyCode ? e.keyCode : e.which);
    if (keycode == '13' && $('#searchBy').val().length > 0) {
      loadBusinessData();
    }
  });

  function appendHTML(business) {
    var html = '<div class="col-md-8 mb-5">' +
      '<h2>' + business.Company + '</h2>' +
      '<hr>' +
      '<p><strong>Address</strong>: ' + business.Address + ', ' + business.City + ', ' + business.State + ', ' + business.Zip + ', ' + business.County + '</p>' +
      '<p><strong>Phone</strong>: ' + business.Phone + '</p>' +
      '<p><strong>Website</strong>: ' + business.Website + '</p>' +
      '<p><strong>Contact</strong>: ' + business.Contact + '</p>' +
      '<p><strong>Title</strong>: ' + business.Title + '</p>' +
      '<p><strong>Direct Phone</strong>: ' + business.Direct_Phone + '</p>' +
      '<p><strong>Email</strong>: ' + business.Email + '</p>' +
      '<p><strong>Sales</strong>: ' + business.Sales + '</p>' +
      '<p><strong>Employees</strong>: ' + business.Employees + '</p>' +
      '<p><strong>SIC Code</strong>: ' + business.SIC_Code + '</p>' +
      '<p><strong>Industry</strong>: ' + business.Industry + '</p>' +
      '</div>';
    return html;
  }

  function loadBusinessData() {
    event.preventDefault();
    fetch('/api/search/' + $('#searchBy').val().trim()).then((data) => {
      return data.json();
    }).then((res) => {
      console.log(res.processingTime + 'seconds');
      $('#resultsDiv').empty();
      res.results.forEach((business) => {
        $('#resultsDiv').append(appendHTML(business));
      });
    });
  }

</script>